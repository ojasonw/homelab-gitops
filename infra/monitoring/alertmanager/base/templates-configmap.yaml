apiVersion: v1
kind: ConfigMap
metadata:
  name: alertmanager-templates
  namespace: monitoring
data:
  template.tmpl: |
    {{ define "__yucca_text_alert_list" }}{{ range . }}
    ---
    â€¼ï¸ <b>{{ .Labels.alertname }}</b>
    {{- if .Annotations.summary }}
    ğŸ“ {{ .Annotations.summary }}{{ end }}
    {{- if .Annotations.description }}
    ğŸ“– {{ .Annotations.description }}{{ end }}
    ğŸ· Labels:
    {{ range .Labels.SortedPairs }}â€¢ <b>{{ .Name | html }}</b>: {{ .Value | html }}
    {{ end }}{{ end }}
    ğŸ›  <a href="https://grafana.artjason.com/">Grafana</a> Â· ğŸ’Š <a href="https://alertmanager.artjason.com/">Alertmanager</a>
    {{ end }}

    {{ define "telegram.default.message" }}
    {{ if gt (len .Alerts.Firing) 0 }}
    {{ $firstAlert := index .Alerts 0 }}
    {{ if eq $firstAlert.Labels.severity "critical" }}
    ğŸ”¥ Critical Alerts ğŸ”¥
    {{ else }}
    âš ï¸  Warning Alerts âš ï¸
    {{ end }}
    {{ template "__yucca_text_alert_list" .Alerts.Firing }}
    {{ end }}
    {{ if gt (len .Alerts.Resolved) 0 }}
    âœ… Alerts Resolved âœ…
    {{ template "__yucca_text_alert_list" .Alerts.Resolved }}
    {{ end }}
    {{ end }}
